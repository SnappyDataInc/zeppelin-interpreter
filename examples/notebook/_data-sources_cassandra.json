{"paragraphs":[{"text":"%snappydata\n\nprintln(\"%html <h3> Specify Dataset name(registered as External table), along with cassandra Host, port, keyspace, table to read from </h3>\")\nprintln(\"%html <h4> <a href='https://github.com/datastax/spark-cassandra-connector/blob/master/doc/1_connecting.md' target='_blank'>Read description of all config options</a> </h4>\")\n","user":"anonymous","dateUpdated":"2018-09-27T14:45:14+0530","config":{"editorSetting":{"language":"text","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/text","editorHide":true,"results":{},"enabled":true,"title":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3> Specify Dataset name(registered as External table), along with cassandra Host, port, keyspace, table to read from </h3>\n"},{"type":"HTML","data":"<h4> <a href='https://github.com/datastax/spark-cassandra-connector/blob/master/doc/1_connecting.md' target='_blank'>Read description of all config options</a> </h4>\n"}]},"apps":[],"jobName":"paragraph_1536573307037_149066695","id":"20180523-005307_463881908","dateCreated":"2018-09-10T15:25:07+0530","dateStarted":"2018-09-19T14:16:12+0530","dateFinished":"2018-09-19T14:16:21+0530","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8029"},{"title":"STEP I : Register the dataset using below Cassandra access options","text":"%snappydata\n\n// this curly brackets around block of code prevents all the REPL output from being displayed ...\n{\nimport com.datastax.spark.connector._\nimport org.apache.spark.sql.cassandra._\nimport com.datastax.spark.connector.cql.CassandraConnectorConf\nimport org.apache.spark.sql.SnappySession\n\nval datasetName = z.input(\"Enter Name for the Dataset:\", \"Invalid-Name\").asInstanceOf[String]\n//val host = z.input(\"Enter any one of Cassandra host IP/Name:\", \"cassandra\")\n//val port = z.input(\"Enter Port:\", \"7077\")\nval keyspace = z.input(\"Enter Keyspace:\", \"test\")\nval table = z.input(\"Enter Table Name:\", \"airlineref\")\n//TODO: Several other important options to be added later ....\n\nz.put(\"datasetName\", datasetName)\n//z.put(\"host\", host)\n//z.put(\"port\", port)\nz.put(\"table\",table)\nz.put(\"keyspace\",keyspace)\nvar connectionString =s\"create external table $datasetName using org.apache.spark.sql.cassandra options (table '$table', keyspace '$keyspace', cluster 'Cluster1'\"\nz.put(\"connectionString\",connectionString)\n}\n","user":"anonymous","dateUpdated":"2018-09-28T11:16:02+0530","config":{"editorSetting":{"language":"text","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/text","editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{"Name the dataset being created:":"df1","URI:":"mongodb://mongodb-mongodb","Database:":"testdb","Collection:":"airlineRef","Sample size (schema inference):":"1000","Partitioner:":"MongoDefaultPartitioner","Any one Cassandra host IP/Name:":"localhost","Port:":"7077","Keyspace:":"demo1","Cassandra tableName:":"emp","Enter Name for the Dataset:":"ds_cassandra3","Enter Any one of Cassandra host IP/Name:":"localhost","Enter Port:":"7077","Enter Keyspace Name:":"demo1","Enter Cassandra Table Name:":"emp","Enter any one of Cassandra host IP/Name:":"localhost","Enter Keyspace:":"demo1","Enter Table Name:":"emp"},"forms":{"Enter Name for the Dataset:":{"name":"Enter Name for the Dataset:","displayName":"Enter Name for the Dataset:","type":"input","defaultValue":"Invalid-Name","hidden":false,"$$hashKey":"object:8229"},"Enter Keyspace:":{"name":"Enter Keyspace:","displayName":"Enter Keyspace:","type":"input","defaultValue":"test","hidden":false,"$$hashKey":"object:8230"},"Enter Table Name:":{"name":"Enter Table Name:","displayName":"Enter Table Name:","type":"input","defaultValue":"airlineref","hidden":false,"$$hashKey":"object:8231"}}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1536573307037_149066695","id":"20180523-001031_1009080999","dateCreated":"2018-09-10T15:25:07+0530","dateStarted":"2018-09-28T11:16:02+0530","dateFinished":"2018-09-28T11:16:02+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8030"},{"title":"STEP II : Enter additional parameters here...","text":"%snappydata\n{  \nvar flag:Boolean=false\nvar key:String=\" \"\nvar value:String=\" \"\nvar map1:Map[String,String] = Map()\nval datasetName =z.get(\"datasetName\").asInstanceOf[String]\nval table=z.get(\"table\").asInstanceOf[String]\nval keyspace=z.get(\"keyspace\").asInstanceOf[String]\nval ss = new org.apache.spark.sql.SnappySession(snc.sparkContext)\nval parameterString = z.input(\"Enter optional parameters in the form of <key>=<value> separated by comma (,)\", \"\").asInstanceOf[String]\n\nif(parameterString != \"\"){\nfor (returnValue <- parameterString.split(\",\"))\n{\n  for(ret <- returnValue.split(\"=\"))\n    {\n      if(flag==false)\n      {\n        key=ret\n        flag=true\n      }\n      else\n      {\n        value=ret\n        flag=false\n       }\n    }\n map1 += key -> value\n }\n    var stringToConcat = \"\"\n    map1.keys.foreach{ j =>\n    var temp=j\n    var temp2=map1(j)\n     stringToConcat += \",\"+temp+\" \"+\"'\"+temp2+\"'\"\n    }\n\n\nss.sql(s\"drop table if exists $datasetName\")\n\nval connectionString=z.get(\"connectionString\").asInstanceOf[String]\nval connectionString2=connectionString.concat(stringToConcat)\nval finalConnectionString=connectionString2.concat(\")\")\nss.sql(finalConnectionString)\n}\nelse{\n println(\"No extra parameter\")\n ss.sql(s\"drop table if exists $datasetName\")\n ss.sql(s\"create external table $datasetName using org.apache.spark.sql.cassandra options (table '$table', keyspace '$keyspace', cluster 'Cluster1')\" )\n}\n\nprintln\nprintln(s\"External table named $datasetName registered.\")\nprintln(s\"====== Schema for $datasetName ======\")\nss.table(datasetName).printSchema\n\n}","user":"anonymous","dateUpdated":"2018-09-28T11:20:52+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","title":true,"editorHide":true},"settings":{"params":{"Give list of parameters:":" ","Enter optional parameters in the form of <key>=<value> separated by comma (,)":""},"forms":{"Enter optional parameters in the form of <key>=<value> separated by comma (,)":{"name":"Enter optional parameters in the form of <key>=<value> separated by comma (,)","displayName":"Enter optional parameters in the form of <key>=<value> separated by comma (,)","type":"input","defaultValue":"","hidden":false,"$$hashKey":"object:8288"}}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"No extra parameter\n\nExternal table named ds_cassandra3 registered.\n====== Schema for ds_cassandra3 ======\nroot\n |-- id: integer (nullable = true)\n |-- name: string (nullable = true)\n |-- salary_id: integer (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1538027373330_325341981","id":"20180927-111933_374698893","dateCreated":"2018-09-27T11:19:33+0530","dateStarted":"2018-09-28T11:20:52+0530","dateFinished":"2018-09-28T11:20:54+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8031"},{"title":"STEP III : Lets take a look at some sample data","text":"%snappydata\n{\nimport org.apache.spark.sql.SnappySession\n\nval ss = new SnappySession(snc.sparkContext)\nval datasetName = z.get(\"datasetName\")\nval host = z.get(\"host\")\n\nss.sql(s\"set spark.cassandra.connection.host=$host\")\nval DF = ss.table(s\"$datasetName\").limit(10)\nz.show(DF)\n}","user":"anonymous","dateUpdated":"2018-09-28T10:10:07+0530","config":{"editorSetting":{"language":"text","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/text","editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"id\tname\tsalary_id\n1\tJohn\t11011034\n2\tRobin\t11011011\n3\tMichael\t11011034\n"}]},"apps":[],"jobName":"paragraph_1536573307038_150220942","id":"20180523-010008_189512033","dateCreated":"2018-09-10T15:25:07+0530","dateStarted":"2018-09-28T10:10:07+0530","dateFinished":"2018-09-28T10:10:13+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8032"},{"title":"STEP IV : Cache the data in SnappyData Row Or Column table","text":"%snappydata\n{\nimport org.apache.spark.sql.SnappySession\n\nval ss = new SnappySession(snc.sparkContext)\n\nval datasetName = z.get(\"datasetName\")\nval tabName = datasetName+ \"_cache\"\nval host = z.get(\"host\")\n\nss.sql(s\"set spark.cassandra.connection.host=$host\")\n\nss.sql(s\"drop table if exists $tabName\")\nss.sql(s\"create table $tabName using row as (select * from $datasetName)\" )\n\nprintln(s\"Created table named $tabName\")\nprintln(\"With row count = \" + ss.table(s\"$tabName\").count )\n}","user":"anonymous","dateUpdated":"2018-09-28T10:10:22+0530","config":{"editorSetting":{"language":"text","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/text","editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Created table named ds_cassandra_cache\nWith row count = 3\n"}]},"apps":[],"jobName":"paragraph_1536573307038_150220942","id":"20180523-195027_1337409592","dateCreated":"2018-09-10T15:25:07+0530","dateStarted":"2018-09-28T10:10:22+0530","dateFinished":"2018-09-28T10:10:27+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8033"},{"text":"%snappydata.sql\n","dateUpdated":"2018-09-25T12:08:19+0530","config":{"colWidth":12,"editorMode":"ace/mode/text","results":{},"enabled":true,"editorSetting":{"language":"text","editOnDblClick":false},"editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1536573307038_150220942","id":"20180523-204306_1374393823","dateCreated":"2018-09-10T15:25:07+0530","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:8034"}],"name":"/data-sources/cassandra","id":"2DQ3PAUNZ","angularObjects":{"2DSMV34N1:shared_process":[],"2DQ8QQ5EY:shared_process":[],"2DP4GUXVM:shared_process":[],"2DP8CFGHC:shared_process":[],"2DPDYBHCB:shared_process":[],"2DRSSH3Q8:shared_process":[],"2DPDH4P21:shared_process":[],"2DQBW5YH3:shared_process":[],"2DRXW65M5:shared_process":[],"2DPDR7CPV:shared_process":[],"2DSR6B4QF:shared_process":[],"2DPHNKBTR:shared_process":[],"2DPDAV3XB:shared_process":[],"2DQEHKQBH:shared_process":[],"2DQ9UUX4S:existing_process":[],"2DQ1FYK4A:shared_process":[],"2DRUTTS6G:shared_process":[],"2DSE9Y3YC:shared_process":[],"2DSM1NJVU:shared_process":[],"2DS3ZGH9R:shared_process":[],"2DR9PEVMA:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}