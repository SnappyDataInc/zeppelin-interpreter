{"paragraphs":[{"title":"Import needed packages","text":"import org.apache.spark._\nimport org.apache.spark.ml._\nimport org.apache.spark.ml.feature._\nimport org.apache.spark.ml.classification._\nimport org.apache.spark.ml.evaluation._\nimport org.apache.spark.ml.tuning._\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nimport spark.implicits._\n","dateUpdated":"2018-05-23T21:47:48+0000","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark._\n\nimport org.apache.spark.ml._\n\nimport org.apache.spark.ml.feature._\n\nimport org.apache.spark.ml.classification._\n\nimport org.apache.spark.ml.evaluation._\n\nimport org.apache.spark.ml.tuning._\n\nimport org.apache.spark.sql._\n\nimport org.apache.spark.sql.functions._\n\nimport org.apache.spark.sql.types._\n\nimport spark.implicits._\n"}]},"apps":[],"jobName":"paragraph_1527112068651_-544969602","id":"20170508-144514_403247535","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9683"},{"text":"%md \nFor this tutorial, we'll be using data from http://www.transtats.bts.gov/DL_SelectFields.asp?Table_ID=236&DB_Short_Name=On-Time.\nThe CSV data has been cleaned and tranformed into 2 JSON files with the following format: \n{\"dofM\":1,\"dofW\":7,\"carrier\":\"AA\",\"fldate\":\"2017-01-01\",\"flnum\":\"1678\",\"origin\":\"ATL\",\"dest\":\"LGA\",\"crsdephour\":17,\"crsdeptime\":1700,\"depdelay\":0.0,\"crsarrtime\":1912,\"arrdelay\":0.0,\"crselapsedtime\":132.0,\"dist\":762.0}\n\nWe use a Scala case class and Structype to define the schema, corresponding to a line in the JSON data file.","dateUpdated":"2018-05-23T21:47:48+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>For this tutorial, we&rsquo;ll be using data from <a href=\"http://www.transtats.bts.gov/DL_SelectFields.asp?Table_ID=236&DB_Short_Name=On-Time\">http://www.transtats.bts.gov/DL_SelectFields.asp?Table_ID=236&DB_Short_Name=On-Time</a>.<br/>The CSV data has been cleaned and tranformed into 2 JSON files with the following format:<br/>{&ldquo;dofM&rdquo;:1,&ldquo;dofW&rdquo;:7,&ldquo;carrier&rdquo;:&ldquo;AA&rdquo;,&ldquo;fldate&rdquo;:&ldquo;2017-01-01&rdquo;,&ldquo;flnum&rdquo;:&ldquo;1678&rdquo;,&ldquo;origin&rdquo;:&ldquo;ATL&rdquo;,&ldquo;dest&rdquo;:&ldquo;LGA&rdquo;,&ldquo;crsdephour&rdquo;:17,&ldquo;crsdeptime&rdquo;:1700,&ldquo;depdelay&rdquo;:0.0,&ldquo;crsarrtime&rdquo;:1912,&ldquo;arrdelay&rdquo;:0.0,&ldquo;crselapsedtime&rdquo;:132.0,&ldquo;dist&rdquo;:762.0}</p>\n<p>We use a Scala case class and Structype to define the schema, corresponding to a line in the JSON data file.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1527112068652_-546893347","id":"20170530-122945_1594214131","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9684"},{"title":"Perform summary statistics  on selected columns","text":"\ndf.describe(\"dist\", \"crselapsedtime\",\"depdelay\", \"arrdelay\").show","dateUpdated":"2018-05-23T21:47:48+0000","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------------+------------------+------------------+------------------+\n|summary|              dist|    crselapsedtime|          depdelay|          arrdelay|\n+-------+------------------+------------------+------------------+------------------+\n|  count|             41348|             41348|             41348|             41348|\n|   mean|1111.0529167069749|186.26264873754474|15.018719164167553|14.806907226468027|\n| stddev| 568.7941212507543| 68.38149648990039| 44.52963204436135| 44.22370513266647|\n|    min|             184.0|              64.0|               0.0|               0.0|\n|    max|            2704.0|             423.0|            1440.0|            1442.0|\n+-------+------------------+------------------+------------------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1527112068654_-546123849","id":"20170524-083228_1459810795","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9685"},{"title":"Calculate the correlation between Departure Delay and Arrival Delay","text":"import org.apache.spark.mllib.stat.Statistics\nval depdelay = df.select(\"depdelay\").map{row:Row => row.getAs[Double](\"depdelay\")}.rdd\nval arrdelay = df.select( \"arrdelay\").map{row:Row => row.getAs[Double](\"arrdelay\")}.rdd\nval correlation = Statistics.corr(depdelay,arrdelay, \"pearson\")","dateUpdated":"2018-05-23T21:47:48+0000","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.mllib.stat.Statistics\n\ndepdelay: org.apache.spark.rdd.RDD[Double] = MapPartitionsRDD[88] at rdd at <console>:80\n\narrdelay: org.apache.spark.rdd.RDD[Double] = MapPartitionsRDD[91] at rdd at <console>:80\n\ncorrelation: Double = 0.9651683038612937\n"}]},"apps":[],"jobName":"paragraph_1527112068654_-546123849","id":"20170524-093152_48310549","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9686"},{"text":"%md \nUse Spark SQL to explore the dataset","dateUpdated":"2018-05-23T21:47:48+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Use Spark SQL to explore the dataset</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1527112068654_-546123849","id":"20170603-182655_1680505289","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9687"},{"title":"Average Departure Delay by Carrier","text":"%sql select carrier, avg(depdelay)\nfrom flights\ngroup by carrier","dateUpdated":"2018-05-23T21:47:48+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"carrier\tavg(depdelay)\nUA\t17.477878450696764\nAA\t10.45768118831622\nDL\t15.316061660865241\nWN\t13.491000418585182\n"}]},"apps":[],"jobName":"paragraph_1527112068654_-546123849","id":"20171110-195759_439800395","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9688"},{"title":"Count of Departure Delays by Origin, Destination","text":"%sql\nselect origin, dest, count(depdelay)\nfrom flights where depdelay > 40\ngroup by origin, dest\nORDER BY count(depdelay) desc\n","dateUpdated":"2018-05-23T21:47:48+0000","config":{"editorSetting":{"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"origin","index":0,"aggr":"sum"}],"groups":[{"name":"dest","index":1,"aggr":"sum"}],"values":[{"name":"count(depdelay)","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"origin\tdest\tcount(depdelay)\nDEN\tSFO\t172\nORD\tSFO\t168\nATL\tLGA\t155\nATL\tEWR\t141\nSFO\tDEN\t134\nLGA\tATL\t130\nORD\tEWR\t122\nSFO\tORD\t118\nEWR\tORD\t115\nORD\tLGA\t100\nIAH\tSFO\t98\nIAH\tEWR\t94\nMIA\tLGA\t92\nORD\tATL\t88\nLGA\tORD\t88\nATL\tSFO\t87\nLGA\tMIA\t81\nSFO\tEWR\t79\nEWR\tSFO\t77\nORD\tDEN\t76\nEWR\tATL\t76\nEWR\tIAH\t75\nATL\tORD\t74\nDEN\tEWR\t73\nEWR\tMIA\t69\nDEN\tLGA\t67\nLGA\tBOS\t67\nEWR\tBOS\t67\nATL\tMIA\t66\nMIA\tEWR\t66\nMIA\tATL\t64\nSFO\tIAH\t62\nBOS\tLGA\t62\nIAH\tLGA\t59\nSFO\tATL\t59\nDEN\tORD\t57\nMIA\tSFO\t57\nIAH\tMIA\t57\nMIA\tIAH\t55\nDEN\tATL\t54\nSFO\tBOS\t52\nBOS\tSFO\t52\nMIA\tORD\t50\nBOS\tATL\t49\nIAH\tORD\t48\nORD\tBOS\t46\nATL\tBOS\t46\nIAH\tDEN\t46\nBOS\tEWR\t45\nATL\tDEN\t43\nBOS\tORD\t43\nORD\tMIA\t43\nDEN\tIAH\t39\nEWR\tDEN\t39\nSFO\tMIA\t38\nORD\tIAH\t36\nLGA\tDEN\t35\nMIA\tBOS\t32\nLGA\tIAH\t31\nIAH\tATL\t27\nATL\tIAH\t25\nBOS\tMIA\t24\nIAH\tBOS\t18\nDEN\tBOS\t15\nMIA\tDEN\t13\nBOS\tDEN\t11\nBOS\tIAH\t10\nDEN\tMIA\t7\n"}]},"apps":[],"jobName":"paragraph_1527112068656_-536120377","id":"20171123-102627_1669385618","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9689"},{"title":"Add Labels for Delayed Flights and count","text":"val delaybucketizer = new Bucketizer().setInputCol(\"depdelay\")\n  .setOutputCol(\"delayed\").setSplits(Array(0.0,40.0,Double.PositiveInfinity))\nval df4= delaybucketizer.transform(df)\ndf4.groupBy(\"delayed\").count.show","dateUpdated":"2018-05-23T21:47:48+0000","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ndelaybucketizer: org.apache.spark.ml.feature.Bucketizer = bucketizer_aa0e5b005983\n\ndf4: org.apache.spark.sql.DataFrame = [_id: string, dofW: int ... 11 more fields]\n+-------+-----+\n|delayed|count|\n+-------+-----+\n|    0.0|36790|\n|    1.0| 4558|\n+-------+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1527112068657_-536505126","id":"20170524-093402_1430077788","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9690"},{"title":"Stratify the sampling to fewer Not Delayed","text":"val fractions = Map(0.0 -> .29, 1.0->1.0)\nval strain = df4.stat.sampleBy(\"delayed\", fractions, 36L)\nstrain.groupBy(\"delayed\").count.show","dateUpdated":"2018-05-23T21:47:48+0000","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nfractions: scala.collection.immutable.Map[Double,Double] = Map(0.0 -> 0.29, 1.0 -> 1.0)\n\nstrain: org.apache.spark.sql.DataFrame = [_id: string, dofW: int ... 11 more fields]\n+-------+-----+\n|delayed|count|\n+-------+-----+\n|    0.0|10560|\n|    1.0| 4558|\n+-------+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1527112068657_-536505126","id":"20171123-050717_1328190278","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9691"},{"text":"%md\nIn order for the features to be used by a machine learning algorithm, they are transformed into numbers representing the value for each feature. Use a combination of StringIndexer and OneHotEncoder to convert the categorical variables in the dataset into numeric variables\n","dateUpdated":"2018-05-23T21:47:48+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>In order for the features to be used by a machine learning algorithm, they are transformed into numbers representing the value for each feature. Use a combination of StringIndexer and OneHotEncoder to convert the categorical variables in the dataset into numeric variables</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1527112068659_-535735628","id":"20170603-184811_78732818","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9692"},{"title":"Use a combination of StringIndexer and OneHotEncoder to encode categorical columns","text":"// categorical Column names\nval categoricalColumns = Array( \"carrier\", \"origin\", \"dest\", \"dofW\")\n// String Indexers will encode string categorial columns\n// into a column numeric indices\nval stringIndexers = categoricalColumns.map { colName =>\n      new StringIndexer()\n        .setInputCol(colName)\n        .setOutputCol(colName + \"Indexed\")\n        .fit(df)\n}\n//OneHotEncoders map number indices column to column of binary vectors\nval encoders = categoricalColumns.map { colName =>\n      new OneHotEncoder()\n        .setInputCol(colName+\"Indexed\")\n        .setOutputCol(colName + \"Enc\")\n}\n","dateUpdated":"2018-05-23T21:47:48+0000","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ncategoricalColumns: Array[String] = Array(carrier, origin, dest, dofW)\n\nstringIndexers: Array[org.apache.spark.ml.feature.StringIndexerModel] = Array(strIdx_22a8aa414a06, strIdx_89947cf5e7ac, strIdx_5649c89ca6b0, strIdx_73aa1c6066f0)\n\nencoders: Array[org.apache.spark.ml.feature.OneHotEncoder] = Array(oneHot_05be21fa4cd8, oneHot_1d732d6848b3, oneHot_ffffb4d7c95f, oneHot_b09904624872)\n"}]},"apps":[],"jobName":"paragraph_1527112068659_-535735628","id":"20170508-150543_958647761","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9693"},{"title":"Use VectorAssembler, a transformer,  to put features into a feature vector column","text":"//bucket the dataset into delayed and not delayed flights with a label 0/1 column \nval labeler = new Bucketizer().setInputCol(\"depdelay\")\n   .setOutputCol(\"label\")\n   .setSplits(Array( 0.0, 40.0, Double.PositiveInfinity))\nval featureCols = Array( \"carrierEnc\", \"destEnc\", \"originEnc\", \n   \"dofWEnc\",\"crsdephour\",\"crselapsedtime\",\"crsarrtime\",\"crsdeptime\",\"dist\")\n//put features into a feature vector column   \nval assembler = new VectorAssembler()\n   .setInputCols(featureCols)\n   .setOutputCol(\"features\")\n\n","dateUpdated":"2018-05-23T21:47:48+0000","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nlabeler: org.apache.spark.ml.feature.Bucketizer = bucketizer_987b931ff411\n\nfeatureCols: Array[String] = Array(carrierEnc, destEnc, originEnc, dofWEnc, crsdephour, crselapsedtime, crsarrtime, crsdeptime, dist)\n\nassembler: org.apache.spark.ml.feature.VectorAssembler = vecAssembler_d004c9b31052\n"}]},"apps":[],"jobName":"paragraph_1527112068659_-535735628","id":"20170524-223310_2121058884","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9694"},{"title":"Create Decision Tree Estimator , set Label and Feature Columns ","text":"val dTree = new DecisionTreeClassifier().setLabelCol(\"label\")\n   .setFeaturesCol(\"features\")\n   .setMaxBins(7000)      ","dateUpdated":"2018-05-24T19:18:03+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ndTree: org.apache.spark.ml.classification.DecisionTreeClassifier = dtc_217a2105b168\n"}]},"apps":[],"jobName":"paragraph_1527112068659_-535735628","id":"20170603-185445_276463997","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9695"},{"text":"%md\nSet up a pipeline to pass the data through transformers to extract the features and label and pass this to a decision tree estimator to fit the model \n\n","dateUpdated":"2018-05-23T21:47:48+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Set up a pipeline to pass the data through transformers to extract the features and label and pass this to a decision tree estimator to fit the model</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1527112068659_-535735628","id":"20170601-154525_1033166149","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9696"},{"title":"Set up pipeline with  feature transformers and model estimator","text":"val steps = stringIndexers ++ encoders  ++  Array(labeler, assembler,  dTree)\nval pipeline = new Pipeline().setStages(steps)\n","dateUpdated":"2018-05-23T21:47:48+0000","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nsteps: Array[org.apache.spark.ml.PipelineStage with org.apache.spark.ml.util.MLWritable{def copy(extra: org.apache.spark.ml.param.ParamMap): org.apache.spark.ml.PipelineStage with org.apache.spark.ml.util.MLWritable{def copy(extra: org.apache.spark.ml.param.ParamMap): org.apache.spark.ml.PipelineStage with org.apache.spark.ml.util.MLWritable}}] = Array(strIdx_22a8aa414a06, strIdx_89947cf5e7ac, strIdx_5649c89ca6b0, strIdx_73aa1c6066f0, oneHot_05be21fa4cd8, oneHot_1d732d6848b3, oneHot_ffffb4d7c95f, oneHot_b09904624872, bucketizer_987b931ff411, vecAssembler_d004c9b31052, dtc_217a2105b168)\n\npipeline: org.apache.spark.ml.Pipeline = pipeline_34fec4a46674\n"}]},"apps":[],"jobName":"paragraph_1527112068660_-537659373","id":"20170508-151557_1422077156","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9697"},{"text":"%md\r\nSpark ML supports k-fold cross validation with a transformation/estimation pipeline to try out different combinations of parameters, using a process called grid search. You set up a CrossValidator with the parameters to test, an estimator and evaluator for a model selection workflow.\r\n","dateUpdated":"2018-05-23T21:47:48+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Spark ML supports k-fold cross validation with a transformation/estimation pipeline to try out different combinations of parameters, using a process called grid search. You set up a CrossValidator with the parameters to test, an estimator and evaluator for a model selection workflow.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1527112068660_-537659373","id":"20170531-154658_1298817002","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9698"},{"title":"Set up a CrossValidator with the parameters, a tree estimator and evaluator","text":"// set param grid to Search through decision tree's maxDepth parameter for best model\n// Deeper trees are potentially more accurate, but are also more likely to overfit.\n val paramGrid = new ParamGridBuilder().addGrid(dTree.maxDepth, Array( 4, 5, 6)).build()\n\nval evaluator = new MulticlassClassificationEvaluator()\n    .setLabelCol(\"label\").setPredictionCol(\"prediction\")\n    .setMetricName(\"accuracy\")   \n\n// Set up 3-fold cross validation with paramGrid\n val crossval = new CrossValidator().setEstimator(pipeline)\n      .setEvaluator (evaluator)\n      .setEstimatorParamMaps(paramGrid).setNumFolds(3)","dateUpdated":"2018-05-23T21:47:48+0000","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\n\n\n\n\n\n\n\nparamGrid: Array[org.apache.spark.ml.param.ParamMap] =\nArray({\n\tdtc_217a2105b168-maxDepth: 4\n}, {\n\tdtc_217a2105b168-maxDepth: 5\n}, {\n\tdtc_217a2105b168-maxDepth: 6\n})\n\nevaluator: org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator = mcEval_10a8caa0863b\n\ncrossval: org.apache.spark.ml.tuning.CrossValidator = cv_9c091d24f7ec\n"}]},"apps":[],"jobName":"paragraph_1527112068660_-537659373","id":"20170508-151903_1365343172","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9699"},{"title":"Fit the model to the input data using K-fold cross validation","text":"val ntrain = strain.drop(\"delayed\").drop(\"arrdelay\")\nprintln(ntrain.count)\nntrain.show","dateUpdated":"2018-05-23T21:47:48+0000","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nntrain: org.apache.spark.sql.DataFrame = [_id: string, dofW: int ... 9 more fields]\n15118\n+--------------------+----+-------+------+----+----------+----------+--------+----------+--------------+------+\n|                 _id|dofW|carrier|origin|dest|crsdephour|crsdeptime|depdelay|crsarrtime|crselapsedtime|  dist|\n+--------------------+----+-------+------+----+----------+----------+--------+----------+--------------+------+\n|AA_2017-01-01_ATL...|   7|     AA|   ATL| LGA|        17|      1700|     0.0|      1912|         132.0| 762.0|\n|AA_2017-01-01_LGA...|   7|     AA|   LGA| MIA|         7|       700|     0.0|      1017|         197.0|1096.0|\n|AA_2017-01-01_DEN...|   7|     AA|   DEN| ORD|        12|      1235|     0.0|      1600|         145.0| 888.0|\n|AA_2017-01-01_MIA...|   7|     AA|   MIA| IAH|        20|      2045|    80.0|      2238|         173.0| 964.0|\n|AA_2017-01-01_MIA...|   7|     AA|   MIA| LGA|        20|      2025|     0.0|      2325|         180.0|1096.0|\n|AA_2017-01-01_ORD...|   7|     AA|   ORD| BOS|        15|      1508|     0.0|      1818|         130.0| 867.0|\n|AA_2017-01-01_MIA...|   7|     AA|   MIA| LGA|        18|      1756|    85.0|      2049|         173.0|1096.0|\n|AA_2017-01-01_MIA...|   7|     AA|   MIA| DEN|        16|      1621|    43.0|      1846|         265.0|1709.0|\n|DL_2017-01-01_MIA...|   7|     DL|   MIA| ATL|        19|      1900|     4.0|      2105|         125.0| 594.0|\n|DL_2017-01-01_BOS...|   7|     DL|   BOS| ATL|        15|      1450|     6.0|      1758|         188.0| 946.0|\n|DL_2017-01-01_SFO...|   7|     DL|   SFO| ATL|         6|       610|     0.0|      1345|         275.0|2139.0|\n|DL_2017-01-01_ATL...|   7|     DL|   ATL| ORD|        15|      1500|    41.0|      1605|         125.0| 606.0|\n|DL_2017-01-01_ORD...|   7|     DL|   ORD| ATL|        12|      1240|    27.0|      1543|         123.0| 606.0|\n|DL_2017-01-01_ATL...|   7|     DL|   ATL| EWR|        19|      1930|    25.0|      2145|         135.0| 746.0|\n|DL_2017-01-01_ORD...|   7|     DL|   ORD| ATL|        10|      1000|     2.0|      1300|         120.0| 606.0|\n|DL_2017-01-01_IAH...|   7|     DL|   IAH| ATL|         6|       600|     0.0|       859|         119.0| 689.0|\n|DL_2017-01-01_BOS...|   7|     DL|   BOS| ATL|        13|      1330|    49.0|      1633|         183.0| 946.0|\n|DL_2017-01-01_ATL...|   7|     DL|   ATL| DEN|         9|       940|     0.0|      1102|         202.0|1199.0|\n|DL_2017-01-01_DEN...|   7|     DL|   DEN| ATL|         6|       600|    10.0|      1102|         182.0|1199.0|\n|DL_2017-01-01_DEN...|   7|     DL|   DEN| ATL|        13|      1317|    70.0|      1808|         171.0|1199.0|\n+--------------------+----+-------+------+----+----------+----------+--------+----------+--------------+------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1527112068660_-537659373","id":"20170508-151926_10766097","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9700"},{"title":"Use Cross Validator Estimator to fit the training data set","text":"val cvModel = crossval.fit(ntrain)","dateUpdated":"2018-05-23T21:47:48+0000","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ncvModel: org.apache.spark.ml.tuning.CrossValidatorModel = cv_9c091d24f7ec\n"}]},"apps":[],"jobName":"paragraph_1527112068661_-538044122","id":"20171129-113112_994877662","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9701"},{"text":"val treeModel = cvModel.bestModel.asInstanceOf[org.apache.spark.ml.PipelineModel].stages.last.asInstanceOf[DecisionTreeClassificationModel]\n","dateUpdated":"2018-05-23T21:47:48+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ntreeModel: org.apache.spark.ml.classification.DecisionTreeClassificationModel = DecisionTreeClassificationModel (uid=dtc_f5e68858efb8) of depth 5 with 63 nodes\n"}]},"apps":[],"jobName":"paragraph_1527112068661_-538044122","id":"20171122-232203_359528816","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9702"},{"text":"treeModel.explainParams() \ntreeModel.extractParamMap\ntreeModel.numNodes\ntreeModel.depth\ntreeModel.toDebugString  // note OneHotEncoding increased the number of features","dateUpdated":"2018-05-23T21:47:48+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\n\n\n\n\n\nres99: String =\ncacheNodeIds: If false, the algorithm will pass trees to executors to match instances with nodes. If true, the algorithm will cache node IDs for each instance. Caching can speed up training of deeper trees. (default: false)\ncheckpointInterval: set checkpoint interval (>= 1) or disable checkpoint (-1). E.g. 10 means that the cache will get checkpointed every 10 iterations (default: 10)\nfeaturesCol: features column name (default: features, current: features)\nimpurity: Criterion used for information gain calculation (case-insensitive). Supported options: entropy, gini (default: gini)\nlabelCol: label column name (default: label, current: label)\nmaxBins: Max number of bins for discretizing continuous features.  Must be >=2 and >= number of categories for any categorical featu...\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nres100: org.apache.spark.ml.param.ParamMap =\n{\n\tdtc_f5e68858efb8-cacheNodeIds: false,\n\tdtc_f5e68858efb8-checkpointInterval: 10,\n\tdtc_f5e68858efb8-featuresCol: features,\n\tdtc_f5e68858efb8-impurity: gini,\n\tdtc_f5e68858efb8-labelCol: label,\n\tdtc_f5e68858efb8-maxBins: 7000,\n\tdtc_f5e68858efb8-maxDepth: 5,\n\tdtc_f5e68858efb8-maxMemoryInMB: 256,\n\tdtc_f5e68858efb8-minInfoGain: 0.0,\n\tdtc_f5e68858efb8-minInstancesPerNode: 1,\n\tdtc_f5e68858efb8-predictionCol: prediction,\n\tdtc_f5e68858efb8-probabilityCol: probability,\n\tdtc_f5e68858efb8-rawPredictionCol: rawPrediction,\n\tdtc_f5e68858efb8-seed: 159147643\n}\n\nres101: Int = 63\n\nres102: Int = 5\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nres103: String =\n\"DecisionTreeClassificationModel (uid=dtc_f5e68858efb8) of depth 5 with 63 nodes\n  If (feature 28 <= 1014.0)\n   If (feature 28 <= 759.0)\n    If (feature 27 <= 913.0)\n     If (feature 29 <= 1620.0)\n      If (feature 28 <= 730.0)\n       Predict: 0.0\n      Else (feature 28 > 730.0)\n       Predict: 0.0\n     Else (feature 29 > 1620.0)\n      If (feature 26 <= 217.0)\n       Predict: 1.0\n      Else (feature 26 > 217.0)\n       Predict: 0.0\n    Else (feature 27 > 913.0)\n     If (feature 27 <= 1529.0)\n      If (feature 7 in {1.0})\n       Predict: 0.0\n      Else (feature 7 not in {1.0})\n       Predict: 0.0\n     Else (feature 27 > 1529.0)\n      If (feature 20 in {0.0})\n       Predict: 0.0\n      Else (feature 20 not in {0.0})\n       Predict: 1.0\n   Else (feature 28 > 759.0)\n    If (f..."}]},"apps":[],"jobName":"paragraph_1527112068661_-538044122","id":"20171122-232845_814296940","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9703"},{"text":"%md\r\nThe actual performance of the model can be determined using the test data set which has not been used for any training or cross-validation activities. We'll transform the test set with the model pipeline, which will map the features according to the same recipe. \r\n","dateUpdated":"2018-05-23T21:47:48+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>The actual performance of the model can be determined using the test data set which has not been used for any training or cross-validation activities. We&rsquo;ll transform the test set with the model pipeline, which will map the features according to the same recipe.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1527112068662_-536889875","id":"20170602-155317_1487132664","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9704"},{"title":"Get Predictions from Test dataset ","text":"//transform the test set with the model pipeline,\n//which will map the features according to the same recipe\nval predictions = cvModel.transform(test)\n","dateUpdated":"2018-05-23T21:47:48+0000","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\npredictions: org.apache.spark.sql.DataFrame = [_id: string, dofW: int ... 23 more fields]\n"}]},"apps":[],"jobName":"paragraph_1527112068662_-536889875","id":"20170508-155848_1997894070","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9705"},{"text":"%md\nAccuracy is measured by the area under the ROC curve. The area measures the ability of the test to correctly classify true positives from false positives. A random predictor would have .5 accuracy. The closer the value is to 1 the better its predictions are. \n\nIn this case, the evaluation returns 82% precision. ","dateUpdated":"2018-05-23T21:47:48+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Accuracy is measured by the area under the ROC curve. The area measures the ability of the test to correctly classify true positives from false positives. A random predictor would have .5 accuracy. The closer the value is to 1 the better its predictions are. </p>\n<p>In this case, the evaluation returns 82% precision.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1527112068662_-536889875","id":"20170602-161538_1648758337","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9706"},{"title":"Evaluate the predictions accuracy","text":"\nval accuracy = evaluator.evaluate(predictions)\n","dateUpdated":"2018-05-23T21:47:48+0000","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\naccuracy: Double = 0.8110147861292026\n"}]},"apps":[],"jobName":"paragraph_1527112068662_-536889875","id":"20170602-155622_1453197792","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9707"},{"title":"Calculate some more metrics","text":"val lp = predictions.select(\"label\", \"prediction\")\nval counttotal = predictions.count()\nval label0count  = lp.filter($\"label\" === 0.0).count()\nval pred0count = lp.filter($\"prediction\" === 0.0).count()\nval label1count = lp.filter($\"label\" === 1.0).count()\nval pred1count = lp.filter($\"prediction\" === 1.0).count()\n\nval correct = lp.filter($\"label\" === $\"prediction\").count()\nval wrong = lp.filter(not($\"label\" === $\"prediction\")).count()\nval ratioWrong = wrong.toDouble / counttotal.toDouble\nval ratioCorrect = correct.toDouble / counttotal.toDouble\nval truep = lp.filter($\"prediction\" === 0.0)\n    .filter($\"label\" === $\"prediction\").count() / counttotal.toDouble\nval truen = lp.filter($\"prediction\" === 1.0)\n    .filter($\"label\" === $\"prediction\").count() / counttotal.toDouble\nval falsep = lp.filter($\"prediction\" === 0.0)\n    .filter(not($\"label\" === $\"prediction\")).count() / counttotal.toDouble\nval falsen = lp.filter($\"prediction\" === 1.0)\n    .filter(not($\"label\" === $\"prediction\")).count() / counttotal.toDouble","dateUpdated":"2018-05-23T21:47:48+0000","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nlp: org.apache.spark.sql.DataFrame = [label: double, prediction: double]\n\ncounttotal: Long = 45448\n\nlabel0count: Long = 39665\n\npred0count: Long = 40304\n\nlabel1count: Long = 5783\n\npred1count: Long = 5144\n\ncorrect: Long = 36859\n\nwrong: Long = 8589\n\nratioWrong: Double = 0.1889852138707974\n\nratioCorrect: Double = 0.8110147861292026\n\ntruep: Double = 0.7852930822038373\n\ntruen: Double = 0.02572170392536525\n\nfalsep: Double = 0.10152261925717303\n\nfalsen: Double = 0.08746259461362436\n"}]},"apps":[],"jobName":"paragraph_1527112068663_-537274624","id":"20171123-065716_47627676","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9708"},{"text":"cvModel.write.overwrite().save(\"/user/user01/data/cfModel\")","dateUpdated":"2018-05-23T21:47:48+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1527112068663_-537274624","id":"20171107-112306_2124778398","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9709"},{"text":"import org.apache.spark.ml.tuning.{CrossValidator, CrossValidatorModel, ParamGridBuilder}\nval sameCVModel = CrossValidatorModel.load(\"/user/user01/data/cfModel\")","dateUpdated":"2018-05-23T21:47:48+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.ml.tuning.{CrossValidator, CrossValidatorModel, ParamGridBuilder}\n\nsameCVModel: org.apache.spark.ml.tuning.CrossValidatorModel = cv_9c16298c9eba\n"}]},"apps":[],"jobName":"paragraph_1527112068663_-537274624","id":"20171107-112400_500996456","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9710"},{"text":"val predictions2 =  sameCVModel.transform(test)","dateUpdated":"2018-05-23T21:47:48+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\npredictions2: org.apache.spark.sql.DataFrame = [_id: string, dofW: int ... 25 more fields]\n"}]},"apps":[],"jobName":"paragraph_1527112068663_-537274624","id":"20171107-112846_1253092466","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9711"},{"text":"predictions2.show","dateUpdated":"2018-05-23T21:47:48+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+----+-------+------+----+----------+----------+--------+----------+--------+--------------+------+-----------+-----------------+--------------+-------------+-----------+-------------+---------------+----------+-------------+-------------+-----+--------------------+---------------+--------------------+----------+\n|                 _id|dofW|carrier|origin|dest|crsdephour|crsdeptime|depdelay|crsarrtime|arrdelay|crselapsedtime|  dist|dofWIndexed|crsdephourIndexed|carrierIndexed|originIndexed|destIndexed|      dofWEnc|  crsdephourEnc|carrierEnc|    originEnc|      destEnc|label|            features|  rawPrediction|         probability|prediction|\n+--------------------+----+-------+------+----+----------+----------+--------+----------+--------+--------------+------+-----------+-----------------+--------------+-------------+-----------+-------------+---------------+----------+-------------+-------------+-----+--------------------+---------------+--------------------+----------+\n|WN_2017-03-01_ATL...|   3|     WN|   ATL| BOS|         9|     930.0|     0.0|    1155.0|     0.0|         145.0| 946.0|        5.0|              9.0|           3.0|          1.0|        8.0|(6,[5],[1.0])| (22,[9],[1.0])| (3,[],[])|(8,[1],[1.0])|    (8,[],[])|  0.0|(51,[5,18,34,47,4...| [1089.0,231.0]|       [0.825,0.175]|       0.0|\n|WN_2017-03-01_ATL...|   3|     WN|   ATL| BOS|        19|    1935.0|   243.0|    2215.0|   210.0|         160.0| 946.0|        5.0|             13.0|           3.0|          1.0|        8.0|(6,[5],[1.0])|(22,[13],[1.0])| (3,[],[])|(8,[1],[1.0])|    (8,[],[])|  1.0|(51,[5,18,38,47,4...|[2175.0,1203.0]|[0.64387211367673...|       0.0|\n|WN_2017-03-01_ATL...|   3|     WN|   ATL| BOS|        12|    1235.0|    11.0|    1505.0|     0.0|         150.0| 946.0|        5.0|             12.0|           3.0|          1.0|        8.0|(6,[5],[1.0])|(22,[12],[1.0])| (3,[],[])|(8,[1],[1.0])|    (8,[],[])|  0.0|(51,[5,18,37,47,4...|[3132.0,1094.0]|[0.74112636062470...|       0.0|\n|WN_2017-03-01_ATL...|   3|     WN|   ATL| DEN|        10|    1035.0|    28.0|    1200.0|    59.0|         205.0|1199.0|        5.0|              2.0|           3.0|          1.0|        4.0|(6,[5],[1.0])| (22,[2],[1.0])| (3,[],[])|(8,[1],[1.0])|(8,[4],[1.0])|  0.0|(51,[5,13,18,27,4...|[3132.0,1094.0]|[0.74112636062470...|       0.0|\n|WN_2017-03-01_ATL...|   3|     WN|   ATL| DEN|        13|    1330.0|    16.0|    1450.0|    29.0|         200.0|1199.0|        5.0|              4.0|           3.0|          1.0|        4.0|(6,[5],[1.0])| (22,[4],[1.0])| (3,[],[])|(8,[1],[1.0])|(8,[4],[1.0])|  0.0|(51,[5,13,18,29,4...|[3132.0,1094.0]|[0.74112636062470...|       0.0|\n|WN_2017-03-01_ATL...|   3|     WN|   ATL| DEN|         6|     610.0|     1.0|     735.0|     3.0|         205.0|1199.0|        5.0|             10.0|           3.0|          1.0|        4.0|(6,[5],[1.0])|(22,[10],[1.0])| (3,[],[])|(8,[1],[1.0])|(8,[4],[1.0])|  0.0|(51,[5,13,18,35,4...|   [814.0,65.0]|[0.92605233219567...|       0.0|\n|WN_2017-03-01_ATL...|   3|     WN|   ATL| DEN|        16|    1635.0|     2.0|    1800.0|    12.0|         205.0|1199.0|        5.0|              8.0|           3.0|          1.0|        4.0|(6,[5],[1.0])| (22,[8],[1.0])| (3,[],[])|(8,[1],[1.0])|(8,[4],[1.0])|  0.0|(51,[5,13,18,33,4...|[3132.0,1094.0]|[0.74112636062470...|       0.0|\n|WN_2017-03-01_ATL...|   3|     WN|   ATL| LGA|        17|    1735.0|    52.0|    1940.0|    57.0|         125.0| 762.0|        5.0|              1.0|           3.0|          1.0|        2.0|(6,[5],[1.0])| (22,[1],[1.0])| (3,[],[])|(8,[1],[1.0])|(8,[2],[1.0])|  1.0|(51,[5,11,18,26,4...|[2175.0,1203.0]|[0.64387211367673...|       0.0|\n|WN_2017-03-01_ATL...|   3|     WN|   ATL| LGA|        13|    1250.0|    52.0|    1455.0|    58.0|         125.0| 762.0|        5.0|              4.0|           3.0|          1.0|        2.0|(6,[5],[1.0])| (22,[4],[1.0])| (3,[],[])|(8,[1],[1.0])|(8,[2],[1.0])|  1.0|(51,[5,11,18,29,4...|[3132.0,1094.0]|[0.74112636062470...|       0.0|\n|WN_2017-03-01_ATL...|   3|     WN|   ATL| LGA|        21|    2055.0|   104.0|    2310.0|    75.0|         135.0| 762.0|        5.0|             15.0|           3.0|          1.0|        2.0|(6,[5],[1.0])|(22,[15],[1.0])| (3,[],[])|(8,[1],[1.0])|(8,[2],[1.0])|  1.0|(51,[5,11,18,40,4...|[2175.0,1203.0]|[0.64387211367673...|       0.0|\n|WN_2017-03-01_ATL...|   3|     WN|   ATL| LGA|         6|     555.0|     0.0|     800.0|     0.0|         125.0| 762.0|        5.0|             10.0|           3.0|          1.0|        2.0|(6,[5],[1.0])|(22,[10],[1.0])| (3,[],[])|(8,[1],[1.0])|(8,[2],[1.0])|  0.0|(51,[5,11,18,35,4...|   [814.0,65.0]|[0.92605233219567...|       0.0|\n|WN_2017-03-01_BOS...|   3|     WN|   BOS| ATL|        14|    1350.0|     1.0|    1650.0|     0.0|         180.0| 946.0|        5.0|              7.0|           3.0|          7.0|        1.0|(6,[5],[1.0])| (22,[7],[1.0])| (3,[],[])|(8,[7],[1.0])|(8,[1],[1.0])|  0.0|(51,[5,10,24,32,4...|[3132.0,1094.0]|[0.74112636062470...|       0.0|\n|WN_2017-03-01_BOS...|   3|     WN|   BOS| ATL|         9|     905.0|     0.0|    1210.0|     0.0|         185.0| 946.0|        5.0|              9.0|           3.0|          7.0|        1.0|(6,[5],[1.0])| (22,[9],[1.0])| (3,[],[])|(8,[7],[1.0])|(8,[1],[1.0])|  0.0|(51,[5,10,24,34,4...| [1089.0,231.0]|       [0.825,0.175]|       0.0|\n|WN_2017-03-01_BOS...|   3|     WN|   BOS| ATL|         6|     625.0|     0.0|     935.0|     0.0|         190.0| 946.0|        5.0|             10.0|           3.0|          7.0|        1.0|(6,[5],[1.0])|(22,[10],[1.0])| (3,[],[])|(8,[7],[1.0])|(8,[1],[1.0])|  0.0|(51,[5,10,24,35,4...|  [941.0,121.0]|[0.88606403013182...|       0.0|\n|WN_2017-03-01_BOS...|   3|     WN|   BOS| DEN|        17|    1745.0|    23.0|    2035.0|    33.0|         290.0|1754.0|        5.0|              1.0|           3.0|          7.0|        4.0|(6,[5],[1.0])| (22,[1],[1.0])| (3,[],[])|(8,[7],[1.0])|(8,[4],[1.0])|  0.0|(51,[5,13,24,26,4...|[2175.0,1203.0]|[0.64387211367673...|       0.0|\n|WN_2017-03-01_DEN...|   3|     WN|   DEN| ATL|         6|     630.0|     0.0|    1120.0|     0.0|         170.0|1199.0|        5.0|             10.0|           3.0|          4.0|        1.0|(6,[5],[1.0])|(22,[10],[1.0])| (3,[],[])|(8,[4],[1.0])|(8,[1],[1.0])|  0.0|(51,[5,10,21,35,4...|  [941.0,121.0]|[0.88606403013182...|       0.0|\n|WN_2017-03-01_DEN...|   3|     WN|   DEN| ATL|        17|    1740.0|     0.0|    2225.0|     0.0|         165.0|1199.0|        5.0|              1.0|           3.0|          4.0|        1.0|(6,[5],[1.0])| (22,[1],[1.0])| (3,[],[])|(8,[4],[1.0])|(8,[1],[1.0])|  0.0|(51,[5,10,21,26,4...|[2175.0,1203.0]|[0.64387211367673...|       0.0|\n|WN_2017-03-01_DEN...|   3|     WN|   DEN| ATL|        10|    1005.0|     0.0|    1455.0|     0.0|         170.0|1199.0|        5.0|              2.0|           3.0|          4.0|        1.0|(6,[5],[1.0])| (22,[2],[1.0])| (3,[],[])|(8,[4],[1.0])|(8,[1],[1.0])|  0.0|(51,[5,10,21,27,4...|  [402.0,135.0]|[0.74860335195530...|       0.0|\n|WN_2017-03-01_DEN...|   3|     WN|   DEN| ATL|        20|    2000.0|     5.0|      45.0|     0.0|         165.0|1199.0|        5.0|             14.0|           3.0|          4.0|        1.0|(6,[5],[1.0])|(22,[14],[1.0])| (3,[],[])|(8,[4],[1.0])|(8,[1],[1.0])|  0.0|(51,[5,10,21,39,4...|[2175.0,1203.0]|[0.64387211367673...|       0.0|\n|WN_2017-03-01_DEN...|   3|     WN|   DEN| BOS|        10|    1005.0|     6.0|    1555.0|     3.0|         230.0|1754.0|        5.0|              2.0|           3.0|          4.0|        8.0|(6,[5],[1.0])| (22,[2],[1.0])| (3,[],[])|(8,[4],[1.0])|    (8,[],[])|  0.0|(51,[5,21,27,47,4...|  [402.0,135.0]|[0.74860335195530...|       0.0|\n+--------------------+----+-------+------+----+----------+----------+--------+----------+--------+--------------+------+-----------+-----------------+--------------+-------------+-----------+-------------+---------------+----------+-------------+-------------+-----+--------------------+---------------+--------------------+----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1527112068664_-539198369","id":"20171107-112947_525619195","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9712"},{"text":"val accuracy2 = evaluator.evaluate(predictions2)\nevaluator.explainParams()","dateUpdated":"2018-05-23T21:47:48+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\naccuracy2: Double = 0.8110147861292026\n\n\n\n\nres83: String =\nlabelCol: label column name (default: label, current: label)\nmetricName: metric name in evaluation (f1|weightedPrecision|weightedRecall|accuracy) (default: f1, current: accuracy)\npredictionCol: prediction column name (default: prediction, current: prediction)\n"}]},"apps":[],"jobName":"paragraph_1527112068664_-539198369","id":"20171107-113000_1427348134","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9713"},{"text":"test.show","dateUpdated":"2018-05-23T21:47:48+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+----+----------+-------+-----+------+----+----------+----------+--------+----------+--------+--------------+------+\n|dofM|dofW|    fldate|carrier|flnum|origin|dest|crsdephour|crsdeptime|depdelay|crsarrtime|arrdelay|crselapsedtime|  dist|\n+----+----+----------+-------+-----+------+----+----------+----------+--------+----------+--------+--------------+------+\n|   1|   3|2017-02-01|     WN| 1421|   ATL| BOS|         9|       930|     0.0|      1155|     0.0|         145.0| 946.0|\n|   1|   3|2017-02-01|     WN| 4079|   ATL| BOS|        19|      1935|    20.0|      2215|     0.0|         160.0| 946.0|\n|   1|   3|2017-02-01|     WN| 4166|   ATL| BOS|        12|      1235|     0.0|      1505|     0.0|         150.0| 946.0|\n|   1|   3|2017-02-01|     WN|  139|   ATL| DEN|        10|      1035|     0.0|      1200|     0.0|         205.0|1199.0|\n|   1|   3|2017-02-01|     WN|  596|   ATL| DEN|        13|      1330|     0.0|      1450|     3.0|         200.0|1199.0|\n|   1|   3|2017-02-01|     WN| 1613|   ATL| DEN|         6|       610|     0.0|       735|     0.0|         205.0|1199.0|\n|   1|   3|2017-02-01|     WN| 4491|   ATL| DEN|        16|      1635|     0.0|      1800|     0.0|         205.0|1199.0|\n|   1|   3|2017-02-01|     WN|  302|   ATL| LGA|        17|      1735|     0.0|      1940|     0.0|         125.0| 762.0|\n|   1|   3|2017-02-01|     WN|  446|   ATL| LGA|         8|       835|     0.0|      1050|     0.0|         135.0| 762.0|\n|   1|   3|2017-02-01|     WN| 1144|   ATL| LGA|        13|      1250|     0.0|      1455|     0.0|         125.0| 762.0|\n|   1|   3|2017-02-01|     WN| 1437|   ATL| LGA|        21|      2055|     0.0|      2310|     0.0|         135.0| 762.0|\n|   1|   3|2017-02-01|     WN| 1602|   ATL| LGA|         6|       555|     0.0|       800|     0.0|         125.0| 762.0|\n|   1|   3|2017-02-01|     WN|  285|   BOS| ATL|        14|      1350|     0.0|      1650|     0.0|         180.0| 946.0|\n|   1|   3|2017-02-01|     WN|  331|   BOS| ATL|         9|       905|     0.0|      1210|     0.0|         185.0| 946.0|\n|   1|   3|2017-02-01|     WN|  335|   BOS| ATL|         6|       625|     0.0|       935|     3.0|         190.0| 946.0|\n|   1|   3|2017-02-01|     WN| 1832|   BOS| DEN|        17|      1745|     0.0|      2035|    49.0|         290.0|1754.0|\n|   1|   3|2017-02-01|     WN|  145|   DEN| ATL|         6|       630|     0.0|      1120|     0.0|         170.0|1199.0|\n|   1|   3|2017-02-01|     WN|  547|   DEN| ATL|        17|      1740|    34.0|      2225|    54.0|         165.0|1199.0|\n|   1|   3|2017-02-01|     WN|  559|   DEN| ATL|        10|      1005|     0.0|      1455|    22.0|         170.0|1199.0|\n|   1|   3|2017-02-01|     WN|  754|   DEN| BOS|        10|      1005|     9.0|      1555|    13.0|         230.0|1754.0|\n+----+----+----------+-------+-----+------+----+----------+----------+--------+----------+--------+--------------+------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1527112068664_-539198369","id":"20171122-090737_1330310819","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9714"},{"dateUpdated":"2018-05-23T21:47:48+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1527112068664_-539198369","id":"20171122-091021_1615582434","dateCreated":"2018-05-23T21:47:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9715"}],"name":"spark-ML-pipeline-FlightDelays","id":"2DFEGV7U7","angularObjects":{},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}